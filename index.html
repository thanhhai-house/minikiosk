<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quản lý phụ tùng</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">quản lý phụ tùng</div>

    <div class="auth">
      <input id="apiUrl" placeholder="Dán Apps Script WebApp URL..." />
      <input id="token" placeholder="token (vd: abc123)" />
      <button id="btnSaveAuth">Lưu</button>
      <span id="authState" class="pill">chưa kết nối</span>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab active" data-tab="products">Sản phẩm</button>
    <button class="tab" data-tab="stock">Tồn kho</button>
    <button class="tab" data-tab="transfer">Chuyển kho</button>
    <button class="tab" data-tab="bill">Bán hàng</button>
    <button class="tab" data-tab="txns">Giao dịch</button>
    <button class="tab" data-tab="bills">Hóa đơn</button>
  </nav>

  <main class="wrap">
    <!-- PRODUCTS -->
    <section id="tab-products" class="panel show">
      <div class="panel-head">
        <h2>PRODUCTS</h2>
        <div class="row">
          <input id="pSearch" placeholder="Tìm theo id / oem / tên..." />
          <button id="btnLoadProducts">Tải</button>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h3>Thêm / Sửa sản phẩm (admin)</h3>
          <div class="form grid">
            <label>ID<input id="p_id" /></label>
            <label>OEM<input id="p_oem" /></label>
            <label>OEM ALT<input id="p_oem_alt" /></label>
            <label>Tên<input id="p_name" /></label>
            <label>Brand<input id="p_brand" /></label>
            <label>Category<input id="p_category" /></label>
            <label>Price<input id="p_price" type="number" /></label>
            <label>Desc<input id="p_desc" /></label>
            <label>Image file id<input id="p_image_file_id" /></label>
            <label>Image url<input id="p_image_url" /></label>
            <label>Image ids<input id="p_image_ids" /></label>
          </div>
          <div class="row">
            <button id="btnUpsertProduct">Lưu sản phẩm</button>
            <button id="btnDeleteProduct" class="danger">Xóa</button>
          </div>
          <p class="hint">created_at / updated_at sẽ tự set trong Apps Script.</p>
        </div>

        <div class="card">
          <h3>Danh sách</h3>
          <div class="tableWrap">
            <table id="productsTable">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- STOCK -->
    <section id="tab-stock" class="panel">
      <div class="panel-head">
        <h2>Tồn kho</h2>
        <button id="btnLoadStock" class="right">Tải tồn</button>
      </div>

      <div class="card">
        <h3>Điều chỉnh tồn (admin)</h3>
        <div class="form grid3">
          <label>Loc
            <select id="s_loc">
              <option>WAREHOUSE</option>
              <option>STORE</option>
            </select>
          </label>
          <label>Product ID<input id="s_product_id" /></label>
          <label>Delta (+/-)<input id="s_delta" type="number" /></label>
          <label>Note<input id="s_note" /></label>
          <label>Actor<input id="s_actor" placeholder="vd: admin" /></label>
        </div>
        <button id="btnAdjustStock">Ghi điều chỉnh</button>
        <p class="hint">Delta âm là trừ kho, dương là cộng kho.</p>
      </div>

      <div class="card">
        <h3>Snapshot</h3>
        <div class="tableWrap">
          <table id="stockTable">
            <thead>
              <tr><th>product_id</th><th>warehouse</th><th>store</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- TRANSFER -->
    <section id="tab-transfer" class="panel">
      <div class="panel-head">
        <h2>Chuyển kho (admin)</h2>
      </div>
      <div class="card">
        <div class="form grid3">
          <label>From
            <select id="t_from">
              <option>WAREHOUSE</option>
              <option>STORE</option>
            </select>
          </label>
          <label>To
            <select id="t_to">
              <option>STORE</option>
              <option>WAREHOUSE</option>
            </select>
          </label>
          <label>Product ID<input id="t_product_id" /></label>
          <label>Qty<input id="t_qty" type="number" /></label>
          <label>Price (optional)<input id="t_price" type="number" /></label>
          <label>Note<input id="t_note" /></label>
          <label>Actor<input id="t_actor" /></label>
        </div>
        <button id="btnTransfer">Chuyển</button>
      </div>
    </section>

    <!-- BILL -->
    <section id="tab-bill" class="panel">
      <div class="panel-head">
        <h2>Tạo hóa đơn (admin)</h2>
      </div>

      <div class="card">
        <div class="form grid3">
          <label>Loc
            <select id="b_loc">
              <option>STORE</option>
              <option>WAREHOUSE</option>
            </select>
          </label>
          <label>Bill ID (optional)<input id="b_bill_id" placeholder="trống = tự tạo" /></label>
          <label>Note<input id="b_note" /></label>
          <label>Actor<input id="b_actor" /></label>
        </div>

        <div class="row">
          <input id="bi_product_id" placeholder="product_id" />
          <input id="bi_qty" type="number" placeholder="qty" />
          <input id="bi_price" type="number" placeholder="price" />
          <button id="btnAddItem">+ Thêm dòng</button>
        </div>

        <div class="tableWrap">
          <table id="billItemsTable">
            <thead><tr><th>product_id</th><th>qty</th><th>price</th><th>line_total</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="row right">
          <div id="billTotal" class="pill">Tổng: 0</div>
          <button id="btnCreateBill">Tạo hóa đơn</button>
        </div>
      </div>
    </section>

    <!-- TXNS -->
    <section id="tab-txns" class="panel">
      <div class="panel-head">
        <h2>TXNS</h2>
        <button id="btnLoadTxns" class="right">Tải</button>
      </div>
      <div class="card">
        <div class="tableWrap">
          <table id="txnsTable"><thead></thead><tbody></tbody></table>
        </div>
      </div>
    </section>

    <!-- BILLS -->
    <section id="tab-bills" class="panel">
      <div class="panel-head">
        <h2>BILLS</h2>
        <button id="btnLoadBills" class="right">Tải</button>
      </div>
      <div class="card">
        <div class="tableWrap">
          <table id="billsTable"><thead></thead><tbody></tbody></table>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">Sheets + Apps Script + GitHub UI</footer>

  <script src="./app.js"></script>
</body>
</html>
