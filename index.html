<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GreenShop Admin - Sản phẩm & Kho</title>

  <!-- Icons -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <link rel="stylesheet" href="styles.css?v=1" />
</head>
<body>
  <!-- Top bar -->
  <div class="topbar">
    <div class="container topbar-inner">
      <div class="topbar-left">
        <span><i class="fa-solid fa-phone"></i> Hotline: <b>0779 030 356</b></span>
        <span class="dot">•</span>
        <span><i class="fa-regular fa-clock"></i> 8:00 - 16:30 (T2 - T7)</span>
      </div>
      <div class="topbar-right">
        <button id="btnLogin" class="btn ghost sm" type="button">
          <i class="fa-solid fa-user-shield"></i>
          <span id="loginLabel">Đăng nhập</span>
        </button>
        <button id="btnInventory" class="btn ghost sm" type="button">
          <i class="fa-solid fa-warehouse"></i>
          Kho (Nhập/Xuất)
        </button>
        <button id="btnImportExport" class="btn ghost sm" type="button">
          <i class="fa-solid fa-file-arrow-up"></i>
          Nhập/Xuất dữ liệu
        </button>
      </div>
    </div>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="container header-inner">
      <a class="brand" href="#">
        <div class="brand-logo"><i class="fa-solid fa-leaf"></i></div>
        <div class="brand-text">
          <div class="brand-title">Green<span>Shop</span></div>
          <div class="brand-sub">Catalog + Inventory (GitHub Pages)</div>
        </div>
      </a>

      <div class="search">
        <div class="field">
          <i class="fa-solid fa-layer-group"></i>
          <select id="categorySelect" class="control">
            <option value="all">Tất cả danh mục</option>
          </select>
        </div>

        <div class="field grow">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input id="searchInput" class="control" placeholder="Tìm theo tên / SKU / thương hiệu..." />
        </div>

        <button id="searchBtn" class="btn primary" type="button">
          <i class="fa-solid fa-magnifying-glass"></i> Tìm
        </button>
      </div>

      <div class="header-actions">
        <div class="pill">
          <i class="fa-solid fa-circle-check"></i>
          <span>Giao diện thật • Preview ảnh • Kho nhập/xuất</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero slider -->
  <section class="hero">
    <div class="container hero-inner">
      <div class="slider" id="slider">
        <div class="slide active">
          <div class="slide-bg bg1"></div>
          <div class="slide-content">
            <div class="kicker">Nền xanh • Modern UI</div>
            <h2>Catalog sản phẩm đẹp như web thật</h2>
            <p>Chạy trên GitHub Pages, lưu IndexedDB, hỗ trợ upload ảnh từ điện thoại + preview trước khi lưu.</p>
            <div class="slide-actions">
              <button class="btn primary" type="button" id="btnQuickAdd">
                <i class="fa-solid fa-plus"></i> Thêm sản phẩm
              </button>
              <button class="btn" type="button" id="btnQuickInventory">
                <i class="fa-solid fa-warehouse"></i> Vào kho
              </button>
            </div>
          </div>
        </div>

        <div class="slide">
          <div class="slide-bg bg2"></div>
          <div class="slide-content">
            <div class="kicker">Nhập / Xuất</div>
            <h2>Quản lý tồn kho bằng phiếu</h2>
            <p>Nhập kho / Xuất kho, xem lịch sử, lọc theo sản phẩm. Dữ liệu lưu riêng.</p>
            <div class="slide-actions">
              <button class="btn primary" type="button" id="btnOpenInventoryFromSlide">
                <i class="fa-solid fa-file-invoice"></i> Tạo phiếu
              </button>
              <button class="btn" type="button" id="btnExportFromSlide">
                <i class="fa-solid fa-download"></i> Xuất dữ liệu
              </button>
            </div>
          </div>
        </div>

        <div class="slider-dots" id="sliderDots"></div>
        <button class="slider-nav prev" id="prevSlide" type="button" aria-label="Prev"><i class="fa-solid fa-chevron-left"></i></button>
        <button class="slider-nav next" id="nextSlide" type="button" aria-label="Next"><i class="fa-solid fa-chevron-right"></i></button>
      </div>

      <div class="hero-side">
        <div class="stat-card">
          <div class="stat-title"><i class="fa-solid fa-boxes-stacked"></i> Tổng sản phẩm</div>
          <div class="stat-value" id="statProducts">0</div>
          <div class="stat-sub">IndexedDB • ổn cho 1000+ sp (text)</div>
        </div>

        <div class="stat-card">
          <div class="stat-title"><i class="fa-solid fa-warehouse"></i> Tổng tồn</div>
          <div class="stat-value" id="statStock">0</div>
          <div class="stat-sub">Tồn = nhập - xuất</div>
        </div>

        <div class="stat-card">
          <div class="stat-title"><i class="fa-solid fa-bolt"></i> Gợi ý</div>
          <div class="stat-sub">
            Nếu muốn lưu ảnh lớn & nhiều → dùng Cloud (Firebase/Supabase/Cloudinary) và lưu URL.
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main -->
  <main class="container main">
    <aside class="sidebar">
      <div class="sidebar-head">
        <div class="sidebar-title"><i class="fa-solid fa-list"></i> Danh mục</div>
        <button class="btn ghost sm" type="button" id="btnResetFilters">
          <i class="fa-solid fa-rotate"></i> Reset
        </button>
      </div>

      <div class="chips" id="categoryChips"></div>

      <div class="sidebar-block">
        <div class="sidebar-title"><i class="fa-solid fa-tags"></i> Thương hiệu</div>
        <div class="chips" id="brandChips"></div>
      </div>

      <div class="sidebar-block">
        <div class="sidebar-title"><i class="fa-solid fa-arrow-up-wide-short"></i> Sắp xếp</div>
        <select id="sortSelect" class="control">
          <option value="newest">Mới nhất</option>
          <option value="az">Tên A → Z</option>
          <option value="za">Tên Z → A</option>
          <option value="stockDesc">Tồn giảm dần</option>
          <option value="stockAsc">Tồn tăng dần</option>
        </select>
      </div>

      <div class="sidebar-block hintbox">
        <div class="hintbox-title"><i class="fa-solid fa-circle-info"></i> Quyền</div>
        <div class="hintbox-sub">
          Khách chỉ xem. Admin mới thêm/sửa/xoá và tạo phiếu nhập/xuất.
        </div>
      </div>
    </aside>

    <section class="content">
      <div class="content-head">
        <div>
          <h1>Danh sách sản phẩm</h1>
          <div class="sub">
            <span id="resultCount">0</span> kết quả •
            <span class="muted">Click sản phẩm để xem nhanh</span>
          </div>
        </div>

        <div class="content-actions">
          <button class="btn primary" id="btnAddProduct" type="button">
            <i class="fa-solid fa-plus"></i> Thêm sản phẩm
          </button>
        </div>
      </div>

      <div class="grid" id="productGrid"></div>

      <div class="empty" id="emptyState" hidden>
        <div class="empty-ico"><i class="fa-regular fa-face-frown"></i></div>
        <div class="empty-title">Không có sản phẩm phù hợp</div>
        <div class="empty-sub">Thử đổi danh mục / thương hiệu / từ khoá.</div>
      </div>
    </section>
  </main>

  <!-- Toast -->
  <div class="toast" id="toast" hidden>
    <i class="fa-solid fa-circle-check"></i>
    <span id="toastText">OK</span>
  </div>

  <!-- MODAL: Login -->
  <div class="modal" id="loginModal" aria-hidden="true">
    <div class="backdrop" data-close="1"></div>
    <div class="modal-card">
      <div class="modal-head">
        <div class="mh-title"><i class="fa-solid fa-user-shield"></i> Đăng nhập Admin</div>
        <button class="icon-btn" data-close="1" type="button"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal-body">
        <div class="note">
          <b>Lưu ý:</b> GitHub Pages là web tĩnh → “admin” chỉ là chế độ giao diện, không phải bảo mật thật.
        </div>

        <div class="form">
          <label>Mật khẩu admin</label>
          <div class="field">
            <i class="fa-solid fa-key"></i>
            <input id="adminPass" class="control" type="password" placeholder="Nhập mật khẩu..." />
          </div>

          <div class="row">
            <button id="adminLoginBtn" class="btn primary" type="button">
              <i class="fa-solid fa-right-to-bracket"></i> Đăng nhập
            </button>
            <button id="adminLogoutBtn" class="btn danger" type="button" hidden>
              <i class="fa-solid fa-right-from-bracket"></i> Đăng xuất
            </button>
          </div>
          <div class="muted">Đổi pass trong <code>app.js</code> → <code>ADMIN_PASSWORD</code></div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Product Add/Edit -->
  <div class="modal" id="productModal" aria-hidden="true">
    <div class="backdrop" data-close="1"></div>
    <div class="modal-card wide">
      <div class="modal-head">
        <div class="mh-title"><i class="fa-solid fa-box"></i> <span id="pmTitle">Thêm sản phẩm</span></div>
        <button class="icon-btn" data-close="1" type="button"><i class="fa-solid fa-xmark"></i></button>
      </div>

      <div class="modal-body">
        <div class="two-col">
          <div>
            <input id="pId" type="hidden"/>

            <div class="form-grid">
              <div class="form">
                <label>Tên sản phẩm *</label>
                <input id="pName" class="control" placeholder="VD: Lọc nhớt Sakura EO-..." />
              </div>

              <div class="form">
                <label>SKU / Mã</label>
                <input id="pSku" class="control" placeholder="VD: EO-88990" />
              </div>

              <div class="form">
                <label>Danh mục *</label>
                <select id="pCategory" class="control"></select>
              </div>

              <div class="form">
                <label>Thương hiệu</label>
                <input id="pBrand" class="control" placeholder="VD: Sakura" />
              </div>

              <div class="form full">
                <label>Mô tả ngắn</label>
                <input id="pDesc" class="control" placeholder="VD: Lọc giấy bền, chính hãng..." />
              </div>

              <div class="form full">
                <label>Ảnh sản phẩm</label>
                <div class="upload">
                  <input id="pImageFile" type="file" accept="image/*" capture="environment"/>
                  <button class="btn" type="button" id="btnPickImage">
                    <i class="fa-regular fa-image"></i> Chọn ảnh từ máy/điện thoại
                  </button>
                  <button class="btn ghost" type="button" id="btnUseUrl">
                    <i class="fa-solid fa-link"></i> Dùng URL
                  </button>
                </div>

                <div id="urlBox" class="urlbox" hidden>
                  <div class="field">
                    <i class="fa-solid fa-link"></i>
                    <input id="pImageUrl" class="control" placeholder="Dán URL ảnh (https://...)" />
                  </div>
                </div>

                <div class="preview">
                  <div class="preview-title">
                    <i class="fa-solid fa-eye"></i> Preview ảnh (trước khi lưu)
                  </div>
                  <div class="preview-box">
                    <img id="pImagePreview" alt="preview" />
                  </div>
                  <div class="muted small">
                    Tip: ảnh quá lớn sẽ làm đầy bộ nhớ trình duyệt. Nên dùng ảnh ~300-600px.
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <button id="saveProductBtn" class="btn primary" type="button">
                <i class="fa-solid fa-floppy-disk"></i> Lưu sản phẩm
              </button>
              <button id="deleteProductBtn" class="btn danger" type="button" hidden>
                <i class="fa-solid fa-trash"></i> Xoá
              </button>
              <button id="resetFormBtn" class="btn" type="button">
                <i class="fa-solid fa-rotate-left"></i> Xoá form
              </button>
            </div>
          </div>

          <div class="quickview">
            <div class="qv-title"><i class="fa-solid fa-bolt"></i> Xem nhanh</div>
            <div class="qv-card" id="qvCard">
              <div class="qv-img"><img id="qvImg" alt="qv"/></div>
              <div class="qv-body">
                <div class="qv-name" id="qvName">Tên sản phẩm</div>
                <div class="qv-meta" id="qvMeta">Danh mục • Thương hiệu • SKU</div>
                <div class="qv-desc" id="qvDesc">Mô tả ngắn</div>
                <div class="qv-stock">
                  <i class="fa-solid fa-warehouse"></i> Tồn: <b id="qvStock">0</b>
                </div>
              </div>
            </div>

            <div class="note">
              Bạn có thể mở <b>Kho (Nhập/Xuất)</b> để tăng/giảm tồn theo phiếu.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Inventory (Nhap/Xuat) -->
  <div class="modal" id="inventoryModal" aria-hidden="true">
    <div class="backdrop" data-close="1"></div>
    <div class="modal-card wide">
      <div class="modal-head">
        <div class="mh-title"><i class="fa-solid fa-warehouse"></i> Kho: Nhập / Xuất</div>
        <button class="icon-btn" data-close="1" type="button"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal-body">
        <div class="tabs">
          <button class="tab active" data-tab="create"><i class="fa-solid fa-pen"></i> Tạo phiếu</button>
          <button class="tab" data-tab="history"><i class="fa-solid fa-clock-rotate-left"></i> Lịch sử</button>
        </div>

        <div class="tabpane active" id="tab-create">
          <div class="form-grid">
            <div class="form">
              <label>Loại</label>
              <select id="mType" class="control">
                <option value="IN">Nhập kho</option>
                <option value="OUT">Xuất kho</option>
              </select>
            </div>

            <div class="form">
              <label>Sản phẩm</label>
              <select id="mProduct" class="control"></select>
            </div>

            <div class="form">
              <label>Số lượng *</label>
              <input id="mQty" class="control" type="number" min="1" step="1" placeholder="VD: 10" />
            </div>

            <div class="form full">
              <label>Ghi chú</label>
              <input id="mNote" class="control" placeholder="VD: Nhập hàng đợt 1 / Xuất cho khách A..." />
            </div>
          </div>

          <div class="row">
            <button id="mSave" class="btn primary" type="button">
              <i class="fa-solid fa-floppy-disk"></i> Lưu phiếu
            </button>
            <div class="muted">Tồn được tính tự động = tổng nhập - tổng xuất.</div>
          </div>

          <div class="line"></div>

          <div class="inventory-table-wrap">
            <div class="inv-head">
              <div class="inv-title"><i class="fa-solid fa-table"></i> Bảng tồn theo sản phẩm</div>
              <div class="field small">
                <i class="fa-solid fa-filter"></i>
                <input id="invFilter" class="control" placeholder="Lọc nhanh (tên / sku)..." />
              </div>
            </div>
            <table class="table">
              <thead>
                <tr>
                  <th>Sản phẩm</th>
                  <th>SKU</th>
                  <th>Danh mục</th>
                  <th>Tồn</th>
                </tr>
              </thead>
              <tbody id="invTableBody"></tbody>
            </table>
          </div>
        </div>

        <div class="tabpane" id="tab-history">
          <div class="inv-head">
            <div class="inv-title"><i class="fa-solid fa-receipt"></i> Lịch sử phiếu</div>
            <div class="field small">
              <i class="fa-solid fa-magnifying-glass"></i>
              <input id="hisFilter" class="control" placeholder="Lọc theo tên / sku / note..." />
            </div>
          </div>

          <div class="history" id="historyList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Import / Export -->
  <div class="modal" id="ieModal" aria-hidden="true">
    <div class="backdrop" data-close="1"></div>
    <div class="modal-card">
      <div class="modal-head">
        <div class="mh-title"><i class="fa-solid fa-file-arrow-up"></i> Nhập / Xuất dữ liệu</div>
        <button class="icon-btn" data-close="1" type="button"><i class="fa-solid fa-xmark"></i></button>
      </div>

      <div class="modal-body">
        <div class="note">
          Xuất ra file <b>JSON</b> để backup, hoặc nhập lại trên máy khác.
        </div>

        <div class="row">
          <button class="btn primary" id="btnExport" type="button">
            <i class="fa-solid fa-download"></i> Xuất JSON (Sản phẩm + Phiếu)
          </button>
          <label class="btn" for="importFile">
            <i class="fa-solid fa-upload"></i> Nhập JSON
          </label>
          <input id="importFile" type="file" accept="application/json" hidden />
        </div>

        <div class="line"></div>

        <div class="note warn">
          <b>Cảnh báo:</b> Nhập JSON sẽ ghi đè dữ liệu hiện có trong trình duyệt.
        </div>

        <div class="row">
          <button class="btn danger" id="btnWipe" type="button">
            <i class="fa-solid fa-bomb"></i> Xoá toàn bộ dữ liệu
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Product Quick View -->
  <div class="modal" id="viewModal" aria-hidden="true">
    <div class="backdrop" data-close="1"></div>
    <div class="modal-card wide">
      <div class="modal-head">
        <div class="mh-title"><i class="fa-regular fa-eye"></i> Chi tiết nhanh</div>
        <button class="icon-btn" data-close="1" type="button"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal-body">
        <div class="view">
          <div class="view-img"><img id="vImg" alt="view"/></div>
          <div class="view-info">
            <div class="view-title" id="vName">Tên</div>
            <div class="view-meta" id="vMeta">meta</div>
            <div class="view-desc" id="vDesc">desc</div>
            <div class="view-stock"><i class="fa-solid fa-warehouse"></i> Tồn: <b id="vStock">0</b></div>
            <div class="row">
              <button class="btn primary" id="btnEditFromView" type="button">
                <i class="fa-solid fa-pen"></i> Sửa (Admin)
              </button>
              <button class="btn" id="btnGoInventoryFromView" type="button">
                <i class="fa-solid fa-warehouse"></i> Nhập/Xuất
              </button>
            </div>
            <div class="muted small">Khách chỉ xem. Admin mới sửa và tạo phiếu.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script defer src="app.js?v=1"></script>
</body>
</html>
